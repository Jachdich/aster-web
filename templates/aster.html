<html>
<head>

<link rel="stylesheet" href="{{ url_for("static", filename="stylesheet.css") }}"></link>

</head>
<body>
<script src="{{ url_for("static", filename="socket.io.js") }}" type="text/javascript"></script>

<div id="idkwhatthisis">
    <div id="channels">
        <ul id="channel_list">
            <button class="channel_item">#general</button>
            <button class="channel_item">#bugs</button>
            <button class="channel_item">#off-topic</button>
        </ul>
    </div>
    <div id="messagearea">
    </div>
</div>

<input rows="1" autofocus="true" id="msgbox"></input>
<script>
let socket = io();

document.getElementById("msgbox").onkeypress = function(key) {
    if (key.keyCode === 13) {
        let elem = document.getElementById("msgbox");
        socket.send({req: "send_message", message: elem.value});
        elem.value = "";
    }
}

socket.on("message", function(data) {
    console.log("message called with data")
    console.log(data)
    const html = `
    <div class="message">
        <span class="pfp">
            <img src="/aster/pfp/${data["author_uuid"]}.png" class="pfp_image"></img>
        </span>
        <span class="uname">${data["author"]}: </span>
        <p class="msgbody">${data["content"]}</p>
        <p class="msgdate">12/05/22 14:32</p>
    </div>
    `
    document.getElementById("messagearea").innerHTML += html;
});

</script>
</body>
</html>
